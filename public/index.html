<!DOCTYPE html>
<html lang="es">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Registro Personas</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom fonts for this template -->
  <link rel="stylesheet" href="vendor/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="vendor/simple-line-icons/css/simple-line-icons.css">
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Muli" rel="stylesheet">

  <!-- Plugin CSS -->
  <link rel="stylesheet" href="device-mockups/device-mockups.min.css">

  <!-- Custom styles for this template -->
  <link href="css/new-age.min.css" rel="stylesheet">
  <link href="css/custom.css" rel="stylesheet">
  <link href="css/no-more-tables.css" rel="stylesheet">

</head>

<body id="page-top">

<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand js-scroll-trigger" href="#page-top">Registro Personas</a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
            data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
            aria-label="Toggle navigation">
      <i class="fa fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#agregar">Agregar</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#personas">Personas</a>
        </li>
        <li class="nav-item">
          <a class="nav-link js-scroll-trigger" href="#admin">Administración</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<header class="masthead">
  <div class="container h-100">
    <div class="row h-100">
      <div class="col-lg-7 my-auto">
        <div class="header-content mx-auto">
          <h1 class="mb-5">
            Registro y visualización de personas usando Go
          </h1>
          <a class="btn btn-outline btn-xl js-scroll-trigger" href="#agregar">Agregar persona</a>
        </div>
      </div>
      <div class="col-lg-5 my-auto">
        <div class="device-container">
          <div class="device-mockup iphone6_plus portrait black">
            <div class="device">
              <div class="screen">
                <!-- Demo image for screen mockup, you can put an image here, some HTML, an animation, video, or anything else! -->
                <img src="img/go-home-screen.png" class="img-fluid" alt="">
              </div>
              <!-- You can hook the "home button" to some JavaScript events or just remove it -->
              <a class="button" href="https://golang.org/" target="_blank">
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<section class="download bg-primary text-center" id="agregar">
  <div class="container">
    <div class="row">
      <div class="col-md-8 mx-auto">
        <h2>Agregar persona</h2>
        <p class="text-muted">Ingresa datos en el formulario y serán persistidos</p>
        <form action="/registrar" method="post" id="registroForm">
          <div class="form-group">
            <label for="nombreInput">Nombre</label>
            <input class="form-control" id="nombreInput" name="nombre"
                   aria-describedby="nombreHelp" placeholder="Nombre" autocomplete="off">
            <small id="nombreHelp" class="form-text text-muted">
              Puedes usar "ScoobyDoo"
            </small>
          </div>
          <div class="form-group">
            <label for="ciudadInput">Ciudad</label>
            <input class="form-control" id="ciudadInput" name="ciudad" placeholder="Ciudad" autocomplete="off">
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input class="form-check-input" type="radio" name="genero" id="generoRadio1" value="masculino">
              Hombre
            </label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input class="form-check-input" type="radio" name="genero" id="generoRadio2" value="femenino">
              Mujer
            </label>
          </div>
          <button class="btn btn-outline btn-xl">Agregar</button>
        </form>
        <!--<h2 class="section-heading">Descubre de que se trata Go</h2>-->
        <!--<p>Our app is available on any mobile device! Download now to get started!</p>-->
        <!--<div class="badges">-->
        <!--<a class="badge-link" href="#"><img src="img/google-play-badge.svg" alt=""></a>-->
        <!--<a class="badge-link" href="#"><img src="img/app-store-badge.svg" alt=""></a>-->
        <!--</div>-->
      </div>
    </div>
  </div>
</section>

<section class="features" id="personas">
  <div class="container">
    <div class="section-heading text-center">
      <h2>Personas registradas</h2>
      <p class="text-muted">Estos son los registros existentes al momento</p>
      <hr>
    </div>
    <table class="table no-more-tables" id="personasTabla">
      <thead class="">
      <tr>
        <th>Nombre</th>
        <th>Ciudad</th>
        <th>Genero</th>
      </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>
</section>

<section class="cta">
  <div class="cta-content">
    <div class="container">
      <h2>Stop waiting.<br>Start building.</h2>
      <a href="#admin" class="btn btn-outline btn-xl js-scroll-trigger">Let's Get Started!</a>
    </div>
  </div>
  <div class="overlay"></div>
</section>

<section class="contact bg-primary" id="admin">
  <div class="container">
    <h2>We
      <i class="fa fa-heart"></i>
      new friends!</h2>
    <ul class="list-inline list-social">
      <li class="list-inline-item social-twitter">
        <a href="#">
          <i class="fa fa-twitter"></i>
        </a>
      </li>
      <li class="list-inline-item social-facebook">
        <a href="#">
          <i class="fa fa-facebook"></i>
        </a>
      </li>
      <li class="list-inline-item social-google-plus">
        <a href="#">
          <i class="fa fa-google-plus"></i>
        </a>
      </li>
    </ul>
  </div>
</section>

<footer>
  <div class="container">
    <p>&copy; 2017 Start Bootstrap. All Rights Reserved.</p>
    <ul class="list-inline">
      <li class="list-inline-item">
        <a href="#">Privacy</a>
      </li>
      <li class="list-inline-item">
        <a href="#">Terms</a>
      </li>
      <li class="list-inline-item">
        <a href="#">FAQ</a>
      </li>
    </ul>
  </div>
</footer>
<!-- Bootstrap core JavaScript -->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/popper/popper.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!-- Plugin JavaScript -->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>
<!-- Custom scripts for this template -->
<script src="js/new-age.min.js"></script>
<script>
    $(document).ready(function () {
        actualizarLista();
    });
    var registroForm = $("#registroForm");
    var personasTabla = $("#personasTabla");
    registroForm.submit(function (e) {
        e.preventDefault();
        $.ajax({
            type: "POST",
            url: "/registrar",
            data: registroForm.serialize(),
            success: function (data) {
                registroForm[0].reset();
                actualizarLista();
            },
            error: function (e) {
                if (e.status == 422) {
                    console.log("Llenar el formulario")
                } else {
                    console.log("error", e);
                }
            }
        })
    });
    var actualizarLista = function () {
        $.ajax({
            type: "GET",
            url: "/personas",
            success: function (data) {
                tbody = personasTabla.find("tbody");
                tbody.html("")
                data.forEach(function (persona) {
                    var tr = $("<tr></tr>");
                    tr.append("<th scope='row' data-title='Nombre'>" + persona.nombre);
                    tr.append("<td data-title='Ciudad'>" + persona.ciudad);
                    tr.append("<td data-title='Genero'>" + persona.genero);
                    tbody.append(tr);
                });
            },
            error: function (e) {
                console.log(e);
            }
        })
    };
</script>
</body>
</html>
